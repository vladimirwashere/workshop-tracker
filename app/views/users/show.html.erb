<% content_for(:title) { t("users.show_title") } %>

<div class="max-w-2xl mx-auto">
  <div class="mb-6">
    <%= render "shared/back_link", fallback: users_path %>
    <h1 class="page-title mt-2"><%= @user.display_name %></h1>
  </div>

  <div class="glass-card divide-y divide-slate-100">
    <div class="p-6">
      <dl class="grid grid-cols-1 gap-6 sm:grid-cols-2">
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.display_name") %></dt>
          <dd class="mt-1 text-sm text-slate-900"><%= @user.display_name %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.email") %></dt>
          <dd class="mt-1 text-sm text-slate-900"><%= @user.email_address %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.role") %></dt>
          <dd class="mt-1"><%= status_badge(@user.role) %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.active") %></dt>
          <dd class="mt-1"><%= active_badge(@user.active) %></dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.confirmed") %></dt>
          <dd class="mt-1">
            <% if @user.confirmed? %>
              <span class="badge bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-800 border border-green-300/30">
                <%= t("users.confirmed") %>
              </span>
            <% else %>
              <span class="badge bg-gradient-to-r from-yellow-500/20 to-amber-500/20 text-yellow-800 border border-yellow-300/30">
                <%= t("users.not_confirmed") %>
              </span>
            <% end %>
          </dd>
        </div>
        <div>
          <dt class="text-sm font-medium text-slate-500"><%= t("users.created_at") %></dt>
          <dd class="mt-1 text-sm text-slate-900"><%= format_date(@user.created_at) %></dd>
        </div>
      </dl>
    </div>

    <div class="p-6 flex items-center gap-3">
      <%= link_to t("common.edit"), edit_user_path(@user), class: "btn-primary" %>

      <% if @user.active? && policy(@user).deactivate? %>
        <%= button_to t("users.deactivate"), deactivate_user_path(@user),
          method: :patch,
          form: { data: { turbo_confirm: t("users.confirm_deactivate") } },
          class: "btn-secondary bg-yellow-500 text-white hover:bg-yellow-600 focus:ring-yellow-500 border-yellow-500" %>
      <% elsif !@user.active? && policy(@user).reactivate? %>
        <%= button_to t("users.reactivate"), reactivate_user_path(@user),
          method: :patch,
          class: "btn-secondary bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 border-green-600" %>
      <% end %>

      <% if policy(@user).reset_password? %>
        <%= button_to t("users.reset_password"), reset_password_user_path(@user),
          method: :post,
          form: { data: { turbo_confirm: t("users.confirm_reset_password") } },
          class: "btn-secondary bg-orange-500 text-white hover:bg-orange-600 focus:ring-orange-500 border-orange-500" %>
      <% end %>

      <% if policy(@user).destroy? %>
        <%= button_to t("common.delete"), soft_delete_user_path(@user),
          method: :delete,
          form: { data: { turbo_confirm: t("users.confirm_delete") } },
          class: "btn-danger" %>
      <% end %>
    </div>
  </div>
</div>
